<html>
    <head>
        <title>Book Catalog</title>
        <link rel="stylesheet" href="styles.css">
    </head>

    <body>
        <div class="Navigaton">
            <ul>
                <li>Catalog</li>
                <li>Store</li>
                <li>About</li>
            </ul>
        </div>
        <div id="testTableBody" class="container">
            <!-- Cards will be dynamically added here -->
        </div>
    </body>
</html>

<script>
    function constructbottomHalfCard(elements)
    {
        let bottomHalf = [];
        headers = ["title", "author", "release-year"]
        for(let i = 0; i < elements.length; i++)
        {
            var div = document.createElement("div");

            div.innerHTML = elements[i]
            bottomHalf.push(div);
            if (i < elements.length-3)
            {
                div.classList.add("card-" + headers[0])
                div.id = headers[0] + i
            }
            else
            {
                div.classList.add("card-" + headers[i])
            }
        }
        return bottomHalf;
    }
    function loadTableData(items)
    {
        const table = document.getElementById("testTableBody");
        items.forEach( line =>
        {
            let wholeCard = document.createElement("span");
            let bottomHalf = document.createElement("span");
            bottomHalf.classList.add("card-bottom");
            bookAttributes = line.split(",");
            constructbottomHalfCard(bookAttributes).forEach( div =>
            {
                bottomHalf.appendChild(div);
            });
            topHalf = document.createElement("span");
            let img = document.createElement("img");
            img.src = "file:///D:/PyCharmProjs/BookStore/Acceptance/"+bookAttributes[0]+".jpg";
            img.alt = "Book cover title";
            img.class = "card-book-cover";
            topHalf.appendChild(img);
            topHalf.classList.add("card-top");
            wholeCard.appendChild(bottomHalf);
            wholeCard.appendChild(topHalf);
            wholeCard.classList.add("card");
            table.appendChild(wholeCard);
        });
    }
    async function getCatalog()
    {
        let data = "";
        fetch("http://127.0.0.1:8091/").then(response => response.text()).then((text) =>
        {
            console.log(text.split("\n"));
            loadTableData(text.split("\n"));
        })
        .catch(error => {
            console.error('Error:', error);
        });
    }
    function start()
    {
        getCatalog();
    }
    let data = start();
</script>
